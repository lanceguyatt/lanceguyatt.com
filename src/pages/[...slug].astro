---
import { getCollection } from 'astro:content'

import Workbench from '~/layouts/Workbench.astro'
import { Prose, Window } from '~/components/index.astro'

export async function getStaticPaths() {
  const pageEntries = await getCollection('page')
  return pageEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry }
  }))
}

const { entry } = Astro.props
const { data, slug } = entry
const { name, description } = data

const { Content } = await entry.render()

const pathname = new URL(Astro.request.url).pathname
---

<Workbench title={name} description={description} url={`/${slug}`}>
  <Window
    id={slug}
    name={`${name}`}
    intent="modal"
    active={pathname === `/${slug}`}
  >
    <div class="w-full max-w-xl border">
      <Prose class="prose">
        <Content />
      </Prose>
    </div>
  </Window>
</Workbench>
